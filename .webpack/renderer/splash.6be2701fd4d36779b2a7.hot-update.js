"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdateprojet_kathara"]("splash",{

/***/ "./src/pages/Playground/components/Canvas/Canvas.tsx":
/*!***********************************************************!*\
  !*** ./src/pages/Playground/components/Canvas/Canvas.tsx ***!
  \***********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.Canvas = void 0;\r\nvar react_1 = __importStar(__webpack_require__(/*! react */ \"./node_modules/react/index.js\"));\r\nvar Canvas_module_scss_1 = __importDefault(__webpack_require__(/*! ./Canvas.module.scss */ \"./src/pages/Playground/components/Canvas/Canvas.module.scss\"));\r\nvar Device_1 = __webpack_require__(/*! ../../../../model/Device */ \"./src/model/Device.tsx\");\r\nvar useColoredImage_1 = __webpack_require__(/*! ../../../../hooks/useColoredImage */ \"./src/hooks/useColoredImage.ts\");\r\nvar useCssVar_1 = __webpack_require__(/*! ../../../../hooks/useCssVar */ \"./src/hooks/useCssVar.ts\");\r\nvar canvaHelper_1 = __webpack_require__(/*! ./canvaHelper */ \"./src/pages/Playground/components/Canvas/canvaHelper.ts\");\r\nvar ContextMenu_1 = __webpack_require__(/*! ../../../../components/ContextMenu/ContextMenu */ \"./src/components/ContextMenu/ContextMenu.tsx\");\r\nvar Canvas = function (_a) {\r\n    var topoJson = _a.topoJson, setSelectedDevices = _a.setSelectedDevices, selectedDevices = _a.selectedDevices, onSave = _a.onSave, onDuplicate = _a.onDuplicate, onNew = _a.onNew, _b = _a.interactive, interactive = _b === void 0 ? true : _b;\r\n    var canvasRef = (0, react_1.useRef)(null);\r\n    var canvasCenter = (0, react_1.useRef)({ x: 0, y: 0 });\r\n    var mouseDownPosRef = (0, react_1.useRef)({ x: 0, y: 0 });\r\n    var mouseButtonDownRef = (0, react_1.useRef)(canvaHelper_1.MouseButtonType.None);\r\n    var isMajPressedRef = (0, react_1.useRef)(false);\r\n    var actionTypeRef = (0, react_1.useRef)(\"select\");\r\n    var getImg = (0, useColoredImage_1.useColoredImage)()[0];\r\n    var color = (0, useCssVar_1.useCssVar)(\"--clr-main-primary\");\r\n    var _c = (0, react_1.useState)(null), mouseDownEvent = _c[0], setMouseDownEvent = _c[1];\r\n    var labOptions = [\r\n        {\r\n            label: 'New', options: Object.entries(Device_1.DeviceType).map(function (_a) {\r\n                var name = _a[0], type = _a[1];\r\n                return {\r\n                    label: name,\r\n                    onClick: function () { return onNew(type); }\r\n                };\r\n            })\r\n        },\r\n        { label: 'Duplicate', disabled: !(selectedDevices === null || selectedDevices === void 0 ? void 0 : selectedDevices.length), onClick: onDuplicate },\r\n        { separator: true },\r\n        { label: 'Save', onClick: onSave },\r\n        { label: 'Export' },\r\n    ];\r\n    var observer = (0, react_1.useRef)(new ResizeObserver(function () {\r\n        console.log(\"resize\");\r\n        resize();\r\n    }));\r\n    var getHSData = function () {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        if (!topoJson.devices.length)\r\n            return;\r\n        var mostLeftDevicePosition = ((_c = (_b = (_a = topoJson.devices) === null || _a === void 0 ? void 0 : _a.reduce(function (prev, curr) {\r\n            return curr.position.x < prev.position.x ? curr : prev;\r\n        })) === null || _b === void 0 ? void 0 : _b.position) === null || _c === void 0 ? void 0 : _c.x) -\r\n            Device_1.deviceSize.width / 2;\r\n        var mostRightDevicePosition = ((_f = (_e = (_d = topoJson.devices) === null || _d === void 0 ? void 0 : _d.reduce(function (prev, curr) {\r\n            return curr.position.x > prev.position.x ? curr : prev;\r\n        })) === null || _e === void 0 ? void 0 : _e.position) === null || _f === void 0 ? void 0 : _f.x) +\r\n            Device_1.deviceSize.width / 2;\r\n        var viewportLeft = 0 - canvasCenter.current.x;\r\n        var viewportRight = canvasRef.current.width - canvasCenter.current.x;\r\n        var mostLeft = Math.min(mostLeftDevicePosition, viewportLeft);\r\n        var mostRight = Math.max(mostRightDevicePosition, viewportRight);\r\n        var innerWidth = viewportRight - viewportLeft;\r\n        var outerWidth = mostRight - mostLeft;\r\n        var offsetRatio = (100 * (viewportLeft - mostLeft)) / outerWidth;\r\n        var ratio = (100 * innerWidth) / outerWidth;\r\n        return {\r\n            ratio: ratio,\r\n            innerWidth: innerWidth,\r\n            outerWidth: outerWidth,\r\n            offsetRatio: offsetRatio,\r\n            viewportLeft: viewportLeft,\r\n            viewportRight: viewportRight,\r\n            mostLeft: mostLeft,\r\n            mostRight: mostRight\r\n        };\r\n    };\r\n    var renderHScrollbars = function () {\r\n        if (!interactive)\r\n            return;\r\n        if (!(topoJson === null || topoJson === void 0 ? void 0 : topoJson.devices.length))\r\n            return;\r\n        var _a = getHSData(), ratio = _a.ratio, offsetRatio = _a.offsetRatio;\r\n        if (ratio === 100)\r\n            return;\r\n        var ctx = canvasRef.current.getContext(\"2d\");\r\n        if (!ctx)\r\n            return;\r\n        ctx.fillStyle = \"#333333\";\r\n        ctx.fillRect(4 * canvaHelper_1.ScrollBarWidth + ((canvasRef.current.width - canvaHelper_1.ScrollBarWidth * 5) * offsetRatio) / 100, canvasRef.current.height - canvaHelper_1.ScrollBarWidth * 2, ((canvasRef.current.width - canvaHelper_1.ScrollBarWidth * 5) * ratio) / 100, canvaHelper_1.ScrollBarWidth);\r\n    };\r\n    var getVSData = function () {\r\n        var _a, _b;\r\n        if (!topoJson.devices.length)\r\n            return;\r\n        var mostTopDevicePosition = ((_a = topoJson.devices) === null || _a === void 0 ? void 0 : _a.reduce(function (prev, curr) {\r\n            return curr.position.y < prev.position.y ? curr : prev;\r\n        }).position.y) -\r\n            Device_1.deviceSize.height / 2;\r\n        var mostBottomDevicePosition = ((_b = topoJson.devices) === null || _b === void 0 ? void 0 : _b.reduce(function (prev, curr) {\r\n            return curr.position.y > prev.position.y ? curr : prev;\r\n        }).position.y) + Device_1.deviceSize.height;\r\n        var viewportTop = 0 - canvasCenter.current.y;\r\n        var viewportBottom = canvasRef.current.height - canvasCenter.current.y;\r\n        var mostTop = Math.min(mostTopDevicePosition, viewportTop);\r\n        var mostBottom = Math.max(mostBottomDevicePosition, viewportBottom);\r\n        var innerWidth = viewportBottom - viewportTop;\r\n        var outerWidth = mostBottom - mostTop;\r\n        var ratio = (100 * innerWidth) / outerWidth;\r\n        var offsetRatio = (100 * (viewportTop - mostTop)) / outerWidth;\r\n        return {\r\n            ratio: ratio,\r\n            innerWidth: innerWidth,\r\n            outerWidth: outerWidth,\r\n            offsetRatio: offsetRatio,\r\n            viewportTop: viewportTop,\r\n            viewportBottom: viewportBottom,\r\n            mostTop: mostTop,\r\n            mostBottom: mostBottom\r\n        };\r\n    };\r\n    var renderVScrollbars = function () {\r\n        if (!interactive)\r\n            return;\r\n        if (!topoJson.devices.length)\r\n            return;\r\n        var _a = getVSData(), ratio = _a.ratio, offsetRatio = _a.offsetRatio;\r\n        if (ratio === 100)\r\n            return;\r\n        var ctx = canvasRef.current.getContext(\"2d\");\r\n        if (!ctx)\r\n            return;\r\n        ctx.fillStyle = \"#333333\";\r\n        ctx.fillRect(10, 10 + ((canvasRef.current.height - canvaHelper_1.ScrollBarWidth * 5) * offsetRatio) / 100, canvaHelper_1.ScrollBarWidth, ((canvasRef.current.height - canvaHelper_1.ScrollBarWidth * 5) * ratio) / 100);\r\n    };\r\n    var lighten = function (color, diff) {\r\n        if (diff === void 0) { diff = 50; }\r\n        return \"#\".concat(Math.min(255, parseInt(color.slice(2, 4), 16) + diff).toString(16).padStart(2, \"0\")).concat(Math.min(255, parseInt(color.slice(4, 6), 16) + diff).toString(16).padStart(2, \"0\")).concat(Math.min(255, parseInt(color.slice(6, 8), 16) + diff).toString(16).padStart(2, '0'));\r\n    };\r\n    var renderJson = function (json) { return __awaiter(void 0, void 0, void 0, function () {\r\n        var ctx, rect, _a;\r\n        var _b;\r\n        return __generator(this, function (_c) {\r\n            switch (_c.label) {\r\n                case 0:\r\n                    ctx = canvasRef.current.getContext(\"2d\");\r\n                    rect = canvasRef.current.getBoundingClientRect();\r\n                    if (!ctx)\r\n                        return [2 /*return*/];\r\n                    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n                    // render links between devices\r\n                    (_b = json.devices) === null || _b === void 0 ? void 0 : _b.forEach(function (device, idx, self) {\r\n                        var _a;\r\n                        (_a = device.interfaces) === null || _a === void 0 ? void 0 : _a.map(function (inter) { return inter.collision_domain; }).filter(Boolean).forEach(function (domain) {\r\n                            json.devices.slice(idx + 1, self.length).forEach(function (dev) {\r\n                                var _a;\r\n                                (_a = dev.interfaces) === null || _a === void 0 ? void 0 : _a.forEach(function (itr) {\r\n                                    if (itr.collision_domain === domain) {\r\n                                        // console.log(`${domain} : ${device.deviceName}_${domain} <-> ${dev.deviceName}_${itr.collision_domain}`)\r\n                                        // console.log(device.position, dev.position, canvasCenter.current)\r\n                                        // ctx.beginPath();\r\n                                        // ctx.strokeStyle = color\r\n                                        // ctx.lineWidth = 3\r\n                                        // ctx.moveTo(device.position.x + canvasCenter.current.x, device.position.y + canvasCenter.current.y);\r\n                                        // ctx.lineTo(dev.position.x + canvasCenter.current.x, dev.position.y + canvasCenter.current.y);\r\n                                        // ctx.stroke();\r\n                                        ctx.fillStyle = \"#c82124\"; //red\r\n                                        ctx.beginPath();\r\n                                        ctx.arc(canvasCenter.current.x, canvasCenter.current.y, 15, 0, Math.PI * 2, true);\r\n                                        ctx.closePath();\r\n                                        ctx.fill();\r\n                                        ctx.ellipse(50, 50, Math.PI / 4, 0, 2 * Math.PI);\r\n                                        // ctx.ellipse(dev.position.x + canvasCenter.current.x, dev.position.y + canvasCenter.current.y, 50, 50, 0, 0, false);\r\n                                    }\r\n                                });\r\n                            });\r\n                        });\r\n                    });\r\n                    // render devices\r\n                    _a = json.devices;\r\n                    if (!_a) \r\n                    // render devices\r\n                    return [3 /*break*/, 2];\r\n                    return [4 /*yield*/, Promise.all(json.devices.map(function (device) {\r\n                            if (!device.position)\r\n                                device.position = (device === null || device === void 0 ? void 0 : device.position) || {\r\n                                    x: rect.width / 2 - canvasCenter.current.x,\r\n                                    y: rect.height / 2 - canvasCenter.current.y,\r\n                                };\r\n                            var selected = selectedDevices === null || selectedDevices === void 0 ? void 0 : selectedDevices.includes(device);\r\n                            var color2 = selected ? lighten(color, 75) : color;\r\n                            return (function () { return __awaiter(void 0, void 0, void 0, function () {\r\n                                var image;\r\n                                return __generator(this, function (_a) {\r\n                                    switch (_a.label) {\r\n                                        case 0: return [4 /*yield*/, getImg(device.type, color2)];\r\n                                        case 1:\r\n                                            image = _a.sent();\r\n                                            image.onload = function () {\r\n                                                ctx.drawImage(image, canvasCenter.current.x + (device === null || device === void 0 ? void 0 : device.position.x) - Device_1.deviceSize.width / 2, canvasCenter.current.y + (device === null || device === void 0 ? void 0 : device.position.y) - Device_1.deviceSize.height / 2, Device_1.deviceSize.width, Device_1.deviceSize.height);\r\n                                            };\r\n                                            image.complete && image.onload(null);\r\n                                            ctx.textAlign = \"center\";\r\n                                            ctx.fillStyle = color2;\r\n                                            ctx.font = \"\".concat(selected ? '800 18px' : '700 16px', \" 'Be Vietnam Pro'\");\r\n                                            ctx.font;\r\n                                            ctx.fillText(device.deviceName, canvasCenter.current.x + (device === null || device === void 0 ? void 0 : device.position.x), canvasCenter.current.y +\r\n                                                (device === null || device === void 0 ? void 0 : device.position.y) -\r\n                                                Device_1.deviceSize.height / 2 +\r\n                                                Device_1.deviceSize.height +\r\n                                                20);\r\n                                            return [2 /*return*/];\r\n                                    }\r\n                                });\r\n                            }); })();\r\n                        }))];\r\n                case 1:\r\n                    _a = (_c.sent());\r\n                    _c.label = 2;\r\n                case 2:\r\n                    // render devices\r\n                    _a;\r\n                    // render scrollbars\r\n                    renderHScrollbars();\r\n                    renderVScrollbars();\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    }); };\r\n    var renderSelection = function (x, y) {\r\n        var ctx = canvasRef.current.getContext(\"2d\");\r\n        ctx.fillStyle = \"rgba(0, 0, 0, 0.5)\";\r\n        ctx.fillRect(mouseDownPosRef.current.x + canvasCenter.current.x, mouseDownPosRef.current.y + canvasCenter.current.y, x - mouseDownPosRef.current.x, y - mouseDownPosRef.current.y);\r\n    };\r\n    var pageMousePositionToCanvasPosition = function (x, y) {\r\n        var rect = canvasRef.current.getBoundingClientRect();\r\n        return {\r\n            x: x - rect.left - canvasCenter.current.x,\r\n            y: y - rect.top - canvasCenter.current.y,\r\n        };\r\n    };\r\n    var getDeviceInZone = function (x1, y1, x2, y2) {\r\n        return topoJson.devices.filter(function (device) {\r\n            return (x2 >= device.position.x - Device_1.deviceSize.width / 2 &&\r\n                x1 <= device.position.x + Device_1.deviceSize.width / 2 &&\r\n                y2 >= device.position.y - Device_1.deviceSize.height / 2 &&\r\n                y1 <= device.position.y + Device_1.deviceSize.height / 2);\r\n        });\r\n    };\r\n    //#region mouse events\r\n    var handleMouseDown = function (e) {\r\n        if (!interactive)\r\n            return;\r\n        mouseButtonDownRef.current = e.buttons;\r\n        renderJson(topoJson);\r\n        if (mouseButtonDownRef.current === canvaHelper_1.MouseButtonType.MiddleClick) {\r\n            canvasRef.current.style.cursor = \"grabbing\";\r\n        }\r\n        else {\r\n            canvasRef.current.style.cursor = \"default\";\r\n        }\r\n        if (mouseButtonDownRef.current === canvaHelper_1.MouseButtonType.RightClick) {\r\n            setMouseDownEvent(e);\r\n        }\r\n        else {\r\n            setMouseDownEvent(null);\r\n        }\r\n        if (e.buttons !== canvaHelper_1.MouseButtonType.LeftClick)\r\n            return;\r\n        var position = pageMousePositionToCanvasPosition(e.pageX, e.pageY);\r\n        mouseDownPosRef.current = position;\r\n        var rect = canvasRef.current.getBoundingClientRect();\r\n        if (e.pageX - rect.left <= 20) {\r\n            return actionTypeRef.current = 'scrollY';\r\n        }\r\n        else if (e.pageY - rect.top >= rect.height - 20) {\r\n            return actionTypeRef.current = 'scrollX';\r\n        }\r\n        var devices = getDeviceInZone(position.x, position.y, position.x, position.y)[0];\r\n        if (devices && !selectedDevices.includes(devices)) {\r\n            setSelectedDevices([devices]);\r\n        }\r\n        if (!devices) {\r\n            actionTypeRef.current = \"select\";\r\n        }\r\n        else if (devices) {\r\n            actionTypeRef.current = \"move\";\r\n        }\r\n    };\r\n    var handleMouseUp = function (e) {\r\n        if (!interactive)\r\n            return;\r\n        if (actionTypeRef.current === \"select\" && mouseButtonDownRef.current === canvaHelper_1.MouseButtonType.LeftClick) {\r\n            renderJson(topoJson);\r\n            var position = pageMousePositionToCanvasPosition(e.pageX, e.pageY);\r\n            setSelectedDevices(getDeviceInZone(Math.min(mouseDownPosRef.current.x, position.x), Math.min(mouseDownPosRef.current.y, position.y), Math.max(mouseDownPosRef.current.x, position.x), Math.max(mouseDownPosRef.current.y, position.y)));\r\n        }\r\n        actionTypeRef.current = \"select\";\r\n        canvasRef.current.style.cursor = \"default\";\r\n        mouseButtonDownRef.current = canvaHelper_1.MouseButtonType.None;\r\n    };\r\n    var handleMouseMove = function (e) { return __awaiter(void 0, void 0, void 0, function () {\r\n        var position;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!interactive)\r\n                        return [2 /*return*/];\r\n                    if (!(mouseButtonDownRef.current === canvaHelper_1.MouseButtonType.MiddleClick)) return [3 /*break*/, 1];\r\n                    canvasCenter.current.x += e.movementX;\r\n                    canvasCenter.current.y += e.movementY;\r\n                    renderJson(topoJson);\r\n                    return [3 /*break*/, 4];\r\n                case 1:\r\n                    if (!(mouseButtonDownRef.current === canvaHelper_1.MouseButtonType.LeftClick &&\r\n                        actionTypeRef.current === \"select\")) return [3 /*break*/, 3];\r\n                    position = pageMousePositionToCanvasPosition(e.pageX, e.pageY);\r\n                    return [4 /*yield*/, renderJson(topoJson)];\r\n                case 2:\r\n                    _a.sent();\r\n                    renderSelection(position.x, position.y);\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    if (mouseButtonDownRef.current === canvaHelper_1.MouseButtonType.LeftClick &&\r\n                        actionTypeRef.current === \"move\") {\r\n                        selectedDevices.forEach(function (device) {\r\n                            device.position.x += e.movementX;\r\n                            device.position.y += e.movementY;\r\n                        });\r\n                        renderJson(topoJson);\r\n                    }\r\n                    else if (mouseButtonDownRef.current === canvaHelper_1.MouseButtonType.LeftClick &&\r\n                        (actionTypeRef.current === \"scrollX\" || actionTypeRef.current === \"scrollY\")) {\r\n                        // TODO: revoir le ration pour bouger la scroll bar plutot que le canvas\r\n                        if (actionTypeRef.current === \"scrollX\") {\r\n                            canvasCenter.current.x -= e.movementX;\r\n                        }\r\n                        else if (actionTypeRef.current === \"scrollY\") {\r\n                            canvasCenter.current.y -= e.movementY;\r\n                        }\r\n                        renderJson(topoJson);\r\n                    }\r\n                    _a.label = 4;\r\n                case 4: return [2 /*return*/];\r\n            }\r\n        });\r\n    }); };\r\n    var handleWheel = function (e) {\r\n        if (!interactive)\r\n            return;\r\n        canvasCenter.current.y -= e.deltaY;\r\n        canvasCenter.current.x -= e.deltaX;\r\n        if (actionTypeRef.current === \"move\" && mouseButtonDownRef.current === canvaHelper_1.MouseButtonType.LeftClick) {\r\n            selectedDevices.forEach(function (device) {\r\n                device.position.y += e.deltaY;\r\n                device.position.y += e.deltaX;\r\n            });\r\n        }\r\n        renderJson(topoJson);\r\n    };\r\n    //#endregion\r\n    //#region keyboard events\r\n    var handleKeyDown = function (e) {\r\n        if (!interactive)\r\n            return;\r\n        if (e.key === \"Shift\") {\r\n            isMajPressedRef.current = true;\r\n        }\r\n        if (e.key === \"a\" && e.ctrlKey) {\r\n            setSelectedDevices(topoJson.devices);\r\n        }\r\n        if (e.key === \"Delete\" || e.key === \"Backspace\") {\r\n            topoJson.devices = topoJson.devices.filter(function (device) { return !selectedDevices.includes(device); });\r\n            setSelectedDevices([]);\r\n        }\r\n    };\r\n    var handleKeyUp = function (e) {\r\n        if (!interactive)\r\n            return;\r\n        if (e.key === \"Shift\") {\r\n            isMajPressedRef.current = false;\r\n        }\r\n    };\r\n    //#endregion\r\n    (0, react_1.useEffect)(function () {\r\n        resize(true);\r\n        if (canvasCenter.current) {\r\n            observer.current.observe(canvasRef.current);\r\n        }\r\n        // start observing for resize\r\n    }, [canvasCenter, observer]);\r\n    var resize = function (changeCenter) {\r\n        if (changeCenter === void 0) { changeCenter = false; }\r\n        if (!canvasRef.current)\r\n            return;\r\n        var rect = canvasRef.current.getBoundingClientRect();\r\n        canvasRef.current.width = rect.width;\r\n        canvasRef.current.height = rect.height;\r\n        if (changeCenter) {\r\n            canvasCenter.current.x = rect.width / 2;\r\n            canvasCenter.current.y = rect.height / 2;\r\n        }\r\n        renderJson(topoJson);\r\n    };\r\n    (0, react_1.useEffect)(function () {\r\n        var fn = function () { return __awaiter(void 0, void 0, void 0, function () { return __generator(this, function (_a) {\r\n            return [2 /*return*/, renderJson(topoJson)];\r\n        }); }); };\r\n        fn();\r\n    }, [topoJson, selectedDevices]);\r\n    (0, react_1.useEffect)(function () {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h;\r\n        if (!interactive) {\r\n            var mostLeftDevicePosition = ((_c = (_b = (_a = topoJson.devices) === null || _a === void 0 ? void 0 : _a.reduce(function (prev, curr) {\r\n                return curr.position.x < prev.position.x ? curr : prev;\r\n            })) === null || _b === void 0 ? void 0 : _b.position) === null || _c === void 0 ? void 0 : _c.x) -\r\n                Device_1.deviceSize.width / 2;\r\n            var mostRightDevicePosition = ((_f = (_e = (_d = topoJson.devices) === null || _d === void 0 ? void 0 : _d.reduce(function (prev, curr) {\r\n                return curr.position.x > prev.position.x ? curr : prev;\r\n            })) === null || _e === void 0 ? void 0 : _e.position) === null || _f === void 0 ? void 0 : _f.x) +\r\n                Device_1.deviceSize.width / 2;\r\n            var mostTopDevicePosition = ((_g = topoJson.devices) === null || _g === void 0 ? void 0 : _g.reduce(function (prev, curr) {\r\n                return curr.position.y < prev.position.y ? curr : prev;\r\n            }).position.y) -\r\n                Device_1.deviceSize.height / 2;\r\n            var mostBottomDevicePosition = ((_h = topoJson.devices) === null || _h === void 0 ? void 0 : _h.reduce(function (prev, curr) {\r\n                return curr.position.y > prev.position.y ? curr : prev;\r\n            }).position.y) + Device_1.deviceSize.height;\r\n            var x = (mostLeftDevicePosition + mostRightDevicePosition) / 2;\r\n            var y = (mostTopDevicePosition + mostBottomDevicePosition) / 2;\r\n            canvasCenter.current.x = canvasCenter.current.x - x;\r\n            canvasCenter.current.y = canvasCenter.current.y - y;\r\n            renderJson(topoJson);\r\n        }\r\n    }, [interactive]);\r\n    function dragOver(e) {\r\n        e.preventDefault();\r\n    }\r\n    function dragEnter(e) {\r\n        e.preventDefault();\r\n    }\r\n    function dragDrop(e) {\r\n        if (!interactive)\r\n            return;\r\n        var device = e.dataTransfer.getData('device') ? JSON.parse(e.dataTransfer.getData('device')) : null;\r\n        if (device) {\r\n            var pos = pageMousePositionToCanvasPosition(e.clientX, e.clientY);\r\n            onNew(device.type, pos);\r\n        }\r\n    }\r\n    return react_1.default.createElement(react_1.default.Fragment, null,\r\n        react_1.default.createElement(\"canvas\", { tabIndex: 0, ref: canvasRef, className: \"\".concat(Canvas_module_scss_1.default.canvas), onMouseDown: handleMouseDown, onMouseUp: handleMouseUp, onMouseLeave: handleMouseUp, onMouseMove: handleMouseMove, onKeyDown: handleKeyDown, onKeyUp: handleKeyUp, onWheel: handleWheel, onDragOver: dragOver, onDragEnter: dragEnter, onDrop: dragDrop }),\r\n        mouseDownEvent && react_1.default.createElement(ContextMenu_1.ContextMenu, { onHide: function () { return setMouseDownEvent(null); }, options: labOptions, position: { x: mouseDownEvent === null || mouseDownEvent === void 0 ? void 0 : mouseDownEvent.clientX, y: (mouseDownEvent === null || mouseDownEvent === void 0 ? void 0 : mouseDownEvent.clientY) - 40 } }));\r\n};\r\nexports.Canvas = Canvas;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFnZXMvUGxheWdyb3VuZC9jb21wb25lbnRzL0NhbnZhcy9DYW52YXMudHN4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSw4RkFRZTtBQUNmLDJKQUF5QztBQUV6Qyw2RkFBMEU7QUFDMUUsdUhBQW9FO0FBQ3BFLHFHQUF3RDtBQUN4RCx3SEFBZ0U7QUFDaEUsOElBQTZFO0FBWXRFLElBQU0sTUFBTSxHQUFHLFVBQUMsRUFRUDtRQVBkLFFBQVEsZ0JBQ1Isa0JBQWtCLDBCQUNsQixlQUFlLHVCQUNmLE1BQU0sY0FDTixXQUFXLG1CQUNYLEtBQUssYUFDTCxtQkFBa0IsRUFBbEIsV0FBVyxtQkFBRyxJQUFJO0lBR2xCLElBQU0sU0FBUyxHQUFHLGtCQUFNLEVBQUMsSUFBSSxDQUFDLENBQUM7SUFDL0IsSUFBTSxZQUFZLEdBQUcsa0JBQU0sRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFFNUMsSUFBTSxlQUFlLEdBQUcsa0JBQU0sRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDL0MsSUFBTSxrQkFBa0IsR0FBRyxrQkFBTSxFQUFrQiw2QkFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRXpFLElBQU0sZUFBZSxHQUFHLGtCQUFNLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFFdEMsSUFBTSxhQUFhLEdBQUcsa0JBQU0sRUFBNEMsUUFBUSxDQUFDLENBQUM7SUFFM0UsVUFBTSxHQUFJLHFDQUFlLEdBQUUsR0FBckIsQ0FBc0I7SUFDbkMsSUFBTSxLQUFLLEdBQUcseUJBQVMsRUFBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQ3hDLFNBQXNDLG9CQUFRLEVBQWEsSUFBSSxDQUFDLEVBQS9ELGNBQWMsVUFBRSxpQkFBaUIsUUFBOEIsQ0FB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LEVBQUUsQ0FBQyxFQUNYLEdBQUcsRUFBRSxTQUFTLEVBQ2QsU0FBUyxFQUFFLFVBQUcsNEJBQUssQ0FBQyxNQUFNLENBQUUsRUFDNUIsV0FBVyxFQUFFLGVBQWUsRUFDNUIsU0FBUyxFQUFFLGFBQWEsRUFDeEIsWUFBWSxFQUFFLGFBQWEsRUFDM0IsV0FBVyxFQUFFLGVBQWUsRUFDNUIsU0FBUyxFQUFFLGFBQWEsRUFDeEIsT0FBTyxFQUFFLFdBQVcsRUFDcEIsT0FBTyxFQUFFLFdBQVcsRUFDcEIsVUFBVSxFQUFFLFFBQVEsRUFDcEIsV0FBVyxFQUFFLFNBQVMsRUFDdEIsTUFBTSxFQUFFLFFBQVEsR0FDUjtRQUNULGNBQWMsSUFBSSw4QkFBQyx5QkFBVyxJQUFDLE1BQU0sRUFBRSxjQUFNLHdCQUFpQixDQUFDLElBQUksQ0FBQyxFQUF2QixDQUF1QixFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLEVBQUUsQ0FBQyxFQUFFLGNBQWMsYUFBZCxjQUFjLHVCQUFkLGNBQWMsQ0FBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLGVBQWMsYUFBZCxjQUFjLHVCQUFkLGNBQWMsQ0FBRSxPQUFPLElBQUcsRUFBRSxFQUFFLEdBQWdCLENBQ3BMO0FBQ0wsQ0FBQyxDQUFDO0FBbmlCVyxjQUFNLFVBbWlCakIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcm9qZXQta2F0aGFyYS8uL3NyYy9wYWdlcy9QbGF5Z3JvdW5kL2NvbXBvbmVudHMvQ2FudmFzL0NhbnZhcy50c3g/NjE2MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtcclxuICB1c2VFZmZlY3QsXHJcbiAgdXNlUmVmLFxyXG4gIE1vdXNlRXZlbnRIYW5kbGVyLFxyXG4gIEtleWJvYXJkRXZlbnRIYW5kbGVyLFxyXG4gIFdoZWVsRXZlbnRIYW5kbGVyLFxyXG4gIHVzZVN0YXRlLFxyXG4gIENoaWxkcmVuLFxyXG59IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgc3R5bGUgZnJvbSBcIi4vQ2FudmFzLm1vZHVsZS5zY3NzXCI7XHJcbmltcG9ydCB7IExhYiB9IGZyb20gXCIuLi8uLi8uLi8uLi9tb2RlbC9MYWJcIjtcclxuaW1wb3J0IHsgRGV2aWNlLCBkZXZpY2VTaXplLCBEZXZpY2VUeXBlIH0gZnJvbSBcIi4uLy4uLy4uLy4uL21vZGVsL0RldmljZVwiO1xyXG5pbXBvcnQgeyB1c2VDb2xvcmVkSW1hZ2UgfSBmcm9tIFwiLi4vLi4vLi4vLi4vaG9va3MvdXNlQ29sb3JlZEltYWdlXCI7XHJcbmltcG9ydCB7IHVzZUNzc1ZhciB9IGZyb20gXCIuLi8uLi8uLi8uLi9ob29rcy91c2VDc3NWYXJcIjtcclxuaW1wb3J0IHsgTW91c2VCdXR0b25UeXBlLCBTY3JvbGxCYXJXaWR0aCB9IGZyb20gXCIuL2NhbnZhSGVscGVyXCI7XHJcbmltcG9ydCB7IENvbnRleHRNZW51IH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvQ29udGV4dE1lbnUvQ29udGV4dE1lbnVcIjtcclxuXHJcbnR5cGUgQ29tcG9uZW50VHlwZSA9IHtcclxuICB0b3BvSnNvbjogTGFiO1xyXG4gIHNldFNlbGVjdGVkRGV2aWNlcz86IChkZXZpY2VzOiBEZXZpY2VbXSkgPT4gdm9pZDtcclxuICBzZWxlY3RlZERldmljZXM/OiBEZXZpY2VbXTtcclxuICBvblNhdmU/OiAoKSA9PiB2b2lkO1xyXG4gIG9uRHVwbGljYXRlPzogKCkgPT4gdm9pZDtcclxuICBvbk5ldz86ICh0eXBlOiBEZXZpY2VUeXBlLCBwb3M/OiB7IHg6IG51bWJlciwgeTogbnVtYmVyIH0pID0+IHZvaWQ7XHJcbiAgaW50ZXJhY3RpdmU6IGJvb2xlYW5cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBDYW52YXMgPSAoe1xyXG4gIHRvcG9Kc29uLFxyXG4gIHNldFNlbGVjdGVkRGV2aWNlcyxcclxuICBzZWxlY3RlZERldmljZXMsXHJcbiAgb25TYXZlLFxyXG4gIG9uRHVwbGljYXRlLFxyXG4gIG9uTmV3LFxyXG4gIGludGVyYWN0aXZlID0gdHJ1ZSxcclxufTogQ29tcG9uZW50VHlwZSkgPT4ge1xyXG5cclxuICBjb25zdCBjYW52YXNSZWYgPSB1c2VSZWYobnVsbCk7XHJcbiAgY29uc3QgY2FudmFzQ2VudGVyID0gdXNlUmVmKHsgeDogMCwgeTogMCB9KTtcclxuXHJcbiAgY29uc3QgbW91c2VEb3duUG9zUmVmID0gdXNlUmVmKHsgeDogMCwgeTogMCB9KTtcclxuICBjb25zdCBtb3VzZUJ1dHRvbkRvd25SZWYgPSB1c2VSZWY8TW91c2VCdXR0b25UeXBlPihNb3VzZUJ1dHRvblR5cGUuTm9uZSk7XHJcblxyXG4gIGNvbnN0IGlzTWFqUHJlc3NlZFJlZiA9IHVzZVJlZihmYWxzZSk7XHJcblxyXG4gIGNvbnN0IGFjdGlvblR5cGVSZWYgPSB1c2VSZWY8XCJtb3ZlXCIgfCBcInNlbGVjdFwiIHwgXCJzY3JvbGxYXCIgfCBcInNjcm9sbFlcIj4oXCJzZWxlY3RcIik7XHJcblxyXG4gIGNvbnN0IFtnZXRJbWddID0gdXNlQ29sb3JlZEltYWdlKCk7XHJcbiAgY29uc3QgY29sb3IgPSB1c2VDc3NWYXIoXCItLWNsci1tYWluLXByaW1hcnlcIik7XHJcbiAgY29uc3QgW21vdXNlRG93bkV2ZW50LCBzZXRNb3VzZURvd25FdmVudF0gPSB1c2VTdGF0ZTxNb3VzZUV2ZW50PihudWxsKTtcclxuXHJcbiAgY29uc3QgbGFiT3B0aW9ucyA9IFtcclxuICAgIHtcclxuICAgICAgbGFiZWw6ICdOZXcnLCBvcHRpb25zOiBPYmplY3QuZW50cmllcyhEZXZpY2VUeXBlKS5tYXAoKFtuYW1lLCB0eXBlXSkgPT4ge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBsYWJlbDogbmFtZSxcclxuICAgICAgICAgIG9uQ2xpY2s6ICgpID0+IG9uTmV3KHR5cGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIHsgbGFiZWw6ICdEdXBsaWNhdGUnLCBkaXNhYmxlZDogIXNlbGVjdGVkRGV2aWNlcz8ubGVuZ3RoLCBvbkNsaWNrOiBvbkR1cGxpY2F0ZSB9LFxyXG4gICAgeyBzZXBhcmF0b3I6IHRydWUgfSxcclxuICAgIHsgbGFiZWw6ICdTYXZlJywgb25DbGljazogb25TYXZlIH0sXHJcbiAgICB7IGxhYmVsOiAnRXhwb3J0JyB9LFxyXG4gIF07XHJcblxyXG4gIGNvbnN0IG9ic2VydmVyID0gdXNlUmVmKFxyXG4gICAgbmV3IFJlc2l6ZU9ic2VydmVyKCgpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJyZXNpemVcIilcclxuICAgICAgcmVzaXplKClcclxuICAgIH0pXHJcbiAgKVxyXG5cclxuICBjb25zdCBnZXRIU0RhdGEgPSAoKSA9PiB7XHJcbiAgICBpZiAoIXRvcG9Kc29uLmRldmljZXMubGVuZ3RoKSByZXR1cm47XHJcblxyXG5cclxuICAgIGNvbnN0IG1vc3RMZWZ0RGV2aWNlUG9zaXRpb24gPVxyXG4gICAgICB0b3BvSnNvbi5kZXZpY2VzPy5yZWR1Y2UoKHByZXYsIGN1cnIpID0+IHtcclxuICAgICAgICByZXR1cm4gY3Vyci5wb3NpdGlvbi54IDwgcHJldi5wb3NpdGlvbi54ID8gY3VyciA6IHByZXY7XHJcbiAgICAgIH0pPy5wb3NpdGlvbj8ueCAtXHJcbiAgICAgIGRldmljZVNpemUud2lkdGggLyAyO1xyXG5cclxuICAgIGNvbnN0IG1vc3RSaWdodERldmljZVBvc2l0aW9uID1cclxuICAgICAgdG9wb0pzb24uZGV2aWNlcz8ucmVkdWNlKChwcmV2LCBjdXJyKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGN1cnIucG9zaXRpb24ueCA+IHByZXYucG9zaXRpb24ueCA/IGN1cnIgOiBwcmV2O1xyXG4gICAgICB9KT8ucG9zaXRpb24/LnggK1xyXG4gICAgICBkZXZpY2VTaXplLndpZHRoIC8gMjtcclxuXHJcbiAgICBjb25zdCB2aWV3cG9ydExlZnQgPSAwIC0gY2FudmFzQ2VudGVyLmN1cnJlbnQueDtcclxuICAgIGNvbnN0IHZpZXdwb3J0UmlnaHQgPSBjYW52YXNSZWYuY3VycmVudC53aWR0aCAtIGNhbnZhc0NlbnRlci5jdXJyZW50Lng7XHJcblxyXG4gICAgY29uc3QgbW9zdExlZnQgPSBNYXRoLm1pbihtb3N0TGVmdERldmljZVBvc2l0aW9uLCB2aWV3cG9ydExlZnQpO1xyXG4gICAgY29uc3QgbW9zdFJpZ2h0ID0gTWF0aC5tYXgobW9zdFJpZ2h0RGV2aWNlUG9zaXRpb24sIHZpZXdwb3J0UmlnaHQpO1xyXG5cclxuICAgIGNvbnN0IGlubmVyV2lkdGggPSB2aWV3cG9ydFJpZ2h0IC0gdmlld3BvcnRMZWZ0O1xyXG4gICAgY29uc3Qgb3V0ZXJXaWR0aCA9IG1vc3RSaWdodCAtIG1vc3RMZWZ0O1xyXG5cclxuICAgIGNvbnN0IG9mZnNldFJhdGlvID0gKDEwMCAqICh2aWV3cG9ydExlZnQgLSBtb3N0TGVmdCkpIC8gb3V0ZXJXaWR0aDtcclxuICAgIGNvbnN0IHJhdGlvID0gKDEwMCAqIGlubmVyV2lkdGgpIC8gb3V0ZXJXaWR0aFxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJhdGlvLFxyXG4gICAgICBpbm5lcldpZHRoLFxyXG4gICAgICBvdXRlcldpZHRoLFxyXG4gICAgICBvZmZzZXRSYXRpbyxcclxuICAgICAgdmlld3BvcnRMZWZ0LFxyXG4gICAgICB2aWV3cG9ydFJpZ2h0LFxyXG4gICAgICBtb3N0TGVmdCwgbW9zdFJpZ2h0XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdCByZW5kZXJIU2Nyb2xsYmFycyA9ICgpID0+IHtcclxuICAgIGlmICghaW50ZXJhY3RpdmUpIHJldHVyblxyXG4gICAgaWYgKCF0b3BvSnNvbj8uZGV2aWNlcy5sZW5ndGgpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCB7IHJhdGlvLCBvZmZzZXRSYXRpbyB9ID0gZ2V0SFNEYXRhKCk7XHJcblxyXG5cclxuICAgIGlmIChyYXRpbyA9PT0gMTAwKSByZXR1cm47XHJcbiAgICBjb25zdCBjdHggPSBjYW52YXNSZWYuY3VycmVudC5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICBpZiAoIWN0eCkgcmV0dXJuO1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwiIzMzMzMzM1wiO1xyXG4gICAgY3R4LmZpbGxSZWN0KFxyXG4gICAgICA0ICogU2Nyb2xsQmFyV2lkdGggKyAoKGNhbnZhc1JlZi5jdXJyZW50LndpZHRoIC0gU2Nyb2xsQmFyV2lkdGggKiA1KSAqIG9mZnNldFJhdGlvKSAvIDEwMCxcclxuICAgICAgY2FudmFzUmVmLmN1cnJlbnQuaGVpZ2h0IC0gU2Nyb2xsQmFyV2lkdGggKiAyLFxyXG4gICAgICAoKGNhbnZhc1JlZi5jdXJyZW50LndpZHRoIC0gU2Nyb2xsQmFyV2lkdGggKiA1KSAqIHJhdGlvKSAvIDEwMCxcclxuICAgICAgU2Nyb2xsQmFyV2lkdGhcclxuICAgICk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0VlNEYXRhID0gKCkgPT4ge1xyXG4gICAgaWYgKCF0b3BvSnNvbi5kZXZpY2VzLmxlbmd0aCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IG1vc3RUb3BEZXZpY2VQb3NpdGlvbiA9XHJcbiAgICAgIHRvcG9Kc29uLmRldmljZXM/LnJlZHVjZSgocHJldiwgY3VycikgPT4ge1xyXG4gICAgICAgIHJldHVybiBjdXJyLnBvc2l0aW9uLnkgPCBwcmV2LnBvc2l0aW9uLnkgPyBjdXJyIDogcHJldjtcclxuICAgICAgfSkucG9zaXRpb24ueSAtXHJcbiAgICAgIGRldmljZVNpemUuaGVpZ2h0IC8gMjtcclxuXHJcbiAgICBjb25zdCBtb3N0Qm90dG9tRGV2aWNlUG9zaXRpb24gPVxyXG4gICAgICB0b3BvSnNvbi5kZXZpY2VzPy5yZWR1Y2UoKHByZXYsIGN1cnIpID0+IHtcclxuICAgICAgICByZXR1cm4gY3Vyci5wb3NpdGlvbi55ID4gcHJldi5wb3NpdGlvbi55ID8gY3VyciA6IHByZXY7XHJcbiAgICAgIH0pLnBvc2l0aW9uLnkgKyBkZXZpY2VTaXplLmhlaWdodDtcclxuXHJcbiAgICBjb25zdCB2aWV3cG9ydFRvcCA9IDAgLSBjYW52YXNDZW50ZXIuY3VycmVudC55O1xyXG4gICAgY29uc3Qgdmlld3BvcnRCb3R0b20gPSBjYW52YXNSZWYuY3VycmVudC5oZWlnaHQgLSBjYW52YXNDZW50ZXIuY3VycmVudC55O1xyXG5cclxuICAgIGNvbnN0IG1vc3RUb3AgPSBNYXRoLm1pbihtb3N0VG9wRGV2aWNlUG9zaXRpb24sIHZpZXdwb3J0VG9wKTtcclxuICAgIGNvbnN0IG1vc3RCb3R0b20gPSBNYXRoLm1heChtb3N0Qm90dG9tRGV2aWNlUG9zaXRpb24sIHZpZXdwb3J0Qm90dG9tKTtcclxuXHJcbiAgICBjb25zdCBpbm5lcldpZHRoID0gdmlld3BvcnRCb3R0b20gLSB2aWV3cG9ydFRvcDtcclxuICAgIGNvbnN0IG91dGVyV2lkdGggPSBtb3N0Qm90dG9tIC0gbW9zdFRvcDtcclxuXHJcbiAgICBjb25zdCByYXRpbyA9ICgxMDAgKiBpbm5lcldpZHRoKSAvIG91dGVyV2lkdGg7XHJcbiAgICBjb25zdCBvZmZzZXRSYXRpbyA9ICgxMDAgKiAodmlld3BvcnRUb3AgLSBtb3N0VG9wKSkgLyBvdXRlcldpZHRoO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJhdGlvLFxyXG4gICAgICBpbm5lcldpZHRoLFxyXG4gICAgICBvdXRlcldpZHRoLFxyXG4gICAgICBvZmZzZXRSYXRpbyxcclxuICAgICAgdmlld3BvcnRUb3AsXHJcbiAgICAgIHZpZXdwb3J0Qm90dG9tLFxyXG4gICAgICBtb3N0VG9wLCBtb3N0Qm90dG9tXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdCByZW5kZXJWU2Nyb2xsYmFycyA9ICgpID0+IHtcclxuICAgIGlmICghaW50ZXJhY3RpdmUpIHJldHVyblxyXG4gICAgaWYgKCF0b3BvSnNvbi5kZXZpY2VzLmxlbmd0aCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHsgcmF0aW8sIG9mZnNldFJhdGlvIH0gPSBnZXRWU0RhdGEoKVxyXG5cclxuICAgIGlmIChyYXRpbyA9PT0gMTAwKSByZXR1cm47XHJcbiAgICBjb25zdCBjdHggPSBjYW52YXNSZWYuY3VycmVudC5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICBpZiAoIWN0eCkgcmV0dXJuO1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwiIzMzMzMzM1wiO1xyXG4gICAgY3R4LmZpbGxSZWN0KFxyXG4gICAgICAxMCxcclxuICAgICAgMTAgKyAoKGNhbnZhc1JlZi5jdXJyZW50LmhlaWdodCAtIFNjcm9sbEJhcldpZHRoICogNSkgKiBvZmZzZXRSYXRpbykgLyAxMDAsXHJcbiAgICAgIFNjcm9sbEJhcldpZHRoLFxyXG4gICAgICAoKGNhbnZhc1JlZi5jdXJyZW50LmhlaWdodCAtIFNjcm9sbEJhcldpZHRoICogNSkgKiByYXRpbykgLyAxMDBcclxuICAgICk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgbGlnaHRlbiA9IChjb2xvcjogc3RyaW5nLCBkaWZmID0gNTApID0+IHtcclxuICAgIHJldHVybiBgIyR7TWF0aC5taW4oMjU1LCBwYXJzZUludChjb2xvci5zbGljZSgyLCA0KSwgMTYpICsgZGlmZikudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsIFwiMFwiKX0ke01hdGgubWluKDI1NSwgcGFyc2VJbnQoY29sb3Iuc2xpY2UoNCwgNiksIDE2KSArIGRpZmYpLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCBcIjBcIil9JHtNYXRoLm1pbigyNTUsIHBhcnNlSW50KGNvbG9yLnNsaWNlKDYsIDgpLCAxNikgKyBkaWZmKS50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKX1gXHJcbiAgfVxyXG5cclxuICBjb25zdCByZW5kZXJKc29uID0gYXN5bmMgKGpzb246IExhYikgPT4ge1xyXG4gICAgY29uc3QgY3R4ID0gY2FudmFzUmVmLmN1cnJlbnQuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgY29uc3QgcmVjdCA9IGNhbnZhc1JlZi5jdXJyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgIGlmICghY3R4KSByZXR1cm47XHJcblxyXG4gICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXNSZWYuY3VycmVudC53aWR0aCwgY2FudmFzUmVmLmN1cnJlbnQuaGVpZ2h0KTtcclxuXHJcbiAgICAvLyByZW5kZXIgbGlua3MgYmV0d2VlbiBkZXZpY2VzXHJcbiAgICBqc29uLmRldmljZXM/LmZvckVhY2goKGRldmljZSwgaWR4LCBzZWxmKSA9PiB7XHJcbiAgICAgIGRldmljZS5pbnRlcmZhY2VzPy5tYXAoaW50ZXIgPT4gaW50ZXIuY29sbGlzaW9uX2RvbWFpbikuZmlsdGVyKEJvb2xlYW4pLmZvckVhY2goZG9tYWluID0+IHtcclxuICAgICAgICBqc29uLmRldmljZXMuc2xpY2UoaWR4ICsgMSwgc2VsZi5sZW5ndGgpLmZvckVhY2goZGV2ID0+IHtcclxuICAgICAgICAgIGRldi5pbnRlcmZhY2VzPy5mb3JFYWNoKChpdHIpID0+IHtcclxuICAgICAgICAgICAgaWYgKGl0ci5jb2xsaXNpb25fZG9tYWluID09PSBkb21haW4pIHtcclxuICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgJHtkb21haW59IDogJHtkZXZpY2UuZGV2aWNlTmFtZX1fJHtkb21haW59IDwtPiAke2Rldi5kZXZpY2VOYW1lfV8ke2l0ci5jb2xsaXNpb25fZG9tYWlufWApXHJcbiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGV2aWNlLnBvc2l0aW9uLCBkZXYucG9zaXRpb24sIGNhbnZhc0NlbnRlci5jdXJyZW50KVxyXG4gICAgICAgICAgICAgIC8vIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAvLyBjdHguc3Ryb2tlU3R5bGUgPSBjb2xvclxyXG4gICAgICAgICAgICAgIC8vIGN0eC5saW5lV2lkdGggPSAzXHJcbiAgICAgICAgICAgICAgLy8gY3R4Lm1vdmVUbyhkZXZpY2UucG9zaXRpb24ueCArIGNhbnZhc0NlbnRlci5jdXJyZW50LngsIGRldmljZS5wb3NpdGlvbi55ICsgY2FudmFzQ2VudGVyLmN1cnJlbnQueSk7XHJcbiAgICAgICAgICAgICAgLy8gY3R4LmxpbmVUbyhkZXYucG9zaXRpb24ueCArIGNhbnZhc0NlbnRlci5jdXJyZW50LngsIGRldi5wb3NpdGlvbi55ICsgY2FudmFzQ2VudGVyLmN1cnJlbnQueSk7XHJcbiAgICAgICAgICAgICAgLy8gY3R4LnN0cm9rZSgpO1xyXG5cclxuICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gXCIjYzgyMTI0XCI7IC8vcmVkXHJcbiAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICAgIGN0eC5hcmMoY2FudmFzQ2VudGVyLmN1cnJlbnQueCwgY2FudmFzQ2VudGVyLmN1cnJlbnQueSwgMTUsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcclxuICAgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgICAgY3R4LmZpbGwoKTtcclxuICAgICAgICAgICAgICBjdHguZWxsaXBzZSgsIDUwLCA1MCwgTWF0aC5QSSAvIDQsIDAsIDIgKiBNYXRoLlBJKTtcclxuICAgICAgICAgICAgICAvLyBjdHguZWxsaXBzZShkZXYucG9zaXRpb24ueCArIGNhbnZhc0NlbnRlci5jdXJyZW50LngsIGRldi5wb3NpdGlvbi55ICsgY2FudmFzQ2VudGVyLmN1cnJlbnQueSwgNTAsIDUwLCAwLCAwLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgfSlcclxuICAgIH0pXHJcblxyXG4gICAgLy8gcmVuZGVyIGRldmljZXNcclxuICAgIGpzb24uZGV2aWNlcyAmJiBhd2FpdCBQcm9taXNlLmFsbChqc29uLmRldmljZXMubWFwKChkZXZpY2UpID0+IHtcclxuICAgICAgaWYgKCFkZXZpY2UucG9zaXRpb24pXHJcbiAgICAgICAgZGV2aWNlLnBvc2l0aW9uID0gZGV2aWNlPy5wb3NpdGlvbiB8fCB7XHJcbiAgICAgICAgICB4OiByZWN0LndpZHRoIC8gMiAtIGNhbnZhc0NlbnRlci5jdXJyZW50LngsXHJcbiAgICAgICAgICB5OiByZWN0LmhlaWdodCAvIDIgLSBjYW52YXNDZW50ZXIuY3VycmVudC55LFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBzZWxlY3RlZCA9IHNlbGVjdGVkRGV2aWNlcz8uaW5jbHVkZXMoZGV2aWNlKTtcclxuICAgICAgY29uc3QgY29sb3IyID0gc2VsZWN0ZWQgPyBsaWdodGVuKGNvbG9yLCA3NSkgOiBjb2xvcjtcclxuXHJcbiAgICAgIHJldHVybiAoYXN5bmMgKCkgPT4ge1xyXG5cclxuICAgICAgICBjb25zdCBpbWFnZSA9IGF3YWl0IGdldEltZyhkZXZpY2UudHlwZSwgY29sb3IyKTtcclxuXHJcbiAgICAgICAgaW1hZ2Uub25sb2FkID0gKCkgPT4ge1xyXG4gICAgICAgICAgY3R4LmRyYXdJbWFnZShcclxuICAgICAgICAgICAgaW1hZ2UsXHJcbiAgICAgICAgICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnggKyBkZXZpY2U/LnBvc2l0aW9uLnggLSBkZXZpY2VTaXplLndpZHRoIC8gMixcclxuICAgICAgICAgICAgY2FudmFzQ2VudGVyLmN1cnJlbnQueSArIGRldmljZT8ucG9zaXRpb24ueSAtIGRldmljZVNpemUuaGVpZ2h0IC8gMixcclxuICAgICAgICAgICAgZGV2aWNlU2l6ZS53aWR0aCxcclxuICAgICAgICAgICAgZGV2aWNlU2l6ZS5oZWlnaHRcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaW1hZ2UuY29tcGxldGUgJiYgaW1hZ2Uub25sb2FkKG51bGwpO1xyXG5cclxuICAgICAgICBjdHgudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcclxuICAgICAgICBjdHguZmlsbFN0eWxlID0gY29sb3IyO1xyXG4gICAgICAgIGN0eC5mb250ID0gYCR7c2VsZWN0ZWQgPyAnODAwIDE4cHgnIDogJzcwMCAxNnB4J30gJ0JlIFZpZXRuYW0gUHJvJ2A7XHJcbiAgICAgICAgY3R4LmZvbnRcclxuICAgICAgICBjdHguZmlsbFRleHQoXHJcbiAgICAgICAgICBkZXZpY2UuZGV2aWNlTmFtZSxcclxuICAgICAgICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnggKyBkZXZpY2U/LnBvc2l0aW9uLngsXHJcbiAgICAgICAgICBjYW52YXNDZW50ZXIuY3VycmVudC55ICtcclxuICAgICAgICAgIGRldmljZT8ucG9zaXRpb24ueSAtXHJcbiAgICAgICAgICBkZXZpY2VTaXplLmhlaWdodCAvIDIgK1xyXG4gICAgICAgICAgZGV2aWNlU2l6ZS5oZWlnaHQgK1xyXG4gICAgICAgICAgMjBcclxuICAgICAgICApO1xyXG4gICAgICB9KSgpO1xyXG5cclxuICAgIH0pKTtcclxuXHJcblxyXG4gICAgLy8gcmVuZGVyIHNjcm9sbGJhcnNcclxuICAgIHJlbmRlckhTY3JvbGxiYXJzKCk7XHJcbiAgICByZW5kZXJWU2Nyb2xsYmFycygpO1xyXG4gIH07XHJcblxyXG5cclxuICBjb25zdCByZW5kZXJTZWxlY3Rpb24gPSAoeDogbnVtYmVyLCB5OiBudW1iZXIpID0+IHtcclxuICAgIGNvbnN0IGN0eCA9IChjYW52YXNSZWYuY3VycmVudCBhcyBIVE1MQ2FudmFzRWxlbWVudCkuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cclxuICAgIGN0eC5maWxsU3R5bGUgPSBcInJnYmEoMCwgMCwgMCwgMC41KVwiO1xyXG4gICAgY3R4LmZpbGxSZWN0KFxyXG4gICAgICBtb3VzZURvd25Qb3NSZWYuY3VycmVudC54ICsgY2FudmFzQ2VudGVyLmN1cnJlbnQueCxcclxuICAgICAgbW91c2VEb3duUG9zUmVmLmN1cnJlbnQueSArIGNhbnZhc0NlbnRlci5jdXJyZW50LnksXHJcbiAgICAgIHggLSBtb3VzZURvd25Qb3NSZWYuY3VycmVudC54LFxyXG4gICAgICB5IC0gbW91c2VEb3duUG9zUmVmLmN1cnJlbnQueVxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBwYWdlTW91c2VQb3NpdGlvblRvQ2FudmFzUG9zaXRpb24gPSAoeDogbnVtYmVyLCB5OiBudW1iZXIpID0+IHtcclxuICAgIGNvbnN0IHJlY3QgPSBjYW52YXNSZWYuY3VycmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiB4IC0gcmVjdC5sZWZ0IC0gY2FudmFzQ2VudGVyLmN1cnJlbnQueCxcclxuICAgICAgeTogeSAtIHJlY3QudG9wIC0gY2FudmFzQ2VudGVyLmN1cnJlbnQueSxcclxuICAgIH07XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0RGV2aWNlSW5ab25lID0gKHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIHgyOiBudW1iZXIsIHkyOiBudW1iZXIpID0+IHtcclxuICAgIHJldHVybiB0b3BvSnNvbi5kZXZpY2VzLmZpbHRlcigoZGV2aWNlKSA9PiB7XHJcbiAgICAgIHJldHVybiAoXHJcbiAgICAgICAgeDIgPj0gZGV2aWNlLnBvc2l0aW9uLnggLSBkZXZpY2VTaXplLndpZHRoIC8gMiAmJlxyXG4gICAgICAgIHgxIDw9IGRldmljZS5wb3NpdGlvbi54ICsgZGV2aWNlU2l6ZS53aWR0aCAvIDIgJiZcclxuICAgICAgICB5MiA+PSBkZXZpY2UucG9zaXRpb24ueSAtIGRldmljZVNpemUuaGVpZ2h0IC8gMiAmJlxyXG4gICAgICAgIHkxIDw9IGRldmljZS5wb3NpdGlvbi55ICsgZGV2aWNlU2l6ZS5oZWlnaHQgLyAyXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICAvLyNyZWdpb24gbW91c2UgZXZlbnRzXHJcblxyXG4gIGNvbnN0IGhhbmRsZU1vdXNlRG93bjogTW91c2VFdmVudEhhbmRsZXIgPSAoZSkgPT4ge1xyXG4gICAgaWYgKCFpbnRlcmFjdGl2ZSkgcmV0dXJuXHJcbiAgICBtb3VzZUJ1dHRvbkRvd25SZWYuY3VycmVudCA9IGUuYnV0dG9ucztcclxuXHJcbiAgICByZW5kZXJKc29uKHRvcG9Kc29uKTtcclxuXHJcbiAgICBpZiAobW91c2VCdXR0b25Eb3duUmVmLmN1cnJlbnQgPT09IE1vdXNlQnV0dG9uVHlwZS5NaWRkbGVDbGljaykge1xyXG4gICAgICBjYW52YXNSZWYuY3VycmVudC5zdHlsZS5jdXJzb3IgPSBcImdyYWJiaW5nXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjYW52YXNSZWYuY3VycmVudC5zdHlsZS5jdXJzb3IgPSBcImRlZmF1bHRcIjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobW91c2VCdXR0b25Eb3duUmVmLmN1cnJlbnQgPT09IE1vdXNlQnV0dG9uVHlwZS5SaWdodENsaWNrKSB7XHJcbiAgICAgIHNldE1vdXNlRG93bkV2ZW50KGUgYXMgYW55KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNldE1vdXNlRG93bkV2ZW50KG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChlLmJ1dHRvbnMgIT09IE1vdXNlQnV0dG9uVHlwZS5MZWZ0Q2xpY2spIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IHBhZ2VNb3VzZVBvc2l0aW9uVG9DYW52YXNQb3NpdGlvbihlLnBhZ2VYLCBlLnBhZ2VZKTtcclxuICAgIG1vdXNlRG93blBvc1JlZi5jdXJyZW50ID0gcG9zaXRpb247XHJcblxyXG4gICAgY29uc3QgcmVjdCA9IGNhbnZhc1JlZi5jdXJyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgaWYgKGUucGFnZVggLSByZWN0LmxlZnQgPD0gMjApIHtcclxuICAgICAgcmV0dXJuIGFjdGlvblR5cGVSZWYuY3VycmVudCA9ICdzY3JvbGxZJztcclxuICAgIH0gZWxzZSBpZiAoZS5wYWdlWSAtIHJlY3QudG9wID49IHJlY3QuaGVpZ2h0IC0gMjApIHtcclxuICAgICAgcmV0dXJuIGFjdGlvblR5cGVSZWYuY3VycmVudCA9ICdzY3JvbGxYJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBbZGV2aWNlc10gPSBnZXREZXZpY2VJblpvbmUoXHJcbiAgICAgIHBvc2l0aW9uLngsXHJcbiAgICAgIHBvc2l0aW9uLnksXHJcbiAgICAgIHBvc2l0aW9uLngsXHJcbiAgICAgIHBvc2l0aW9uLnlcclxuICAgICk7XHJcblxyXG4gICAgaWYgKGRldmljZXMgJiYgIXNlbGVjdGVkRGV2aWNlcy5pbmNsdWRlcyhkZXZpY2VzKSkge1xyXG4gICAgICBzZXRTZWxlY3RlZERldmljZXMoW2RldmljZXNdKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWRldmljZXMpIHtcclxuICAgICAgYWN0aW9uVHlwZVJlZi5jdXJyZW50ID0gXCJzZWxlY3RcIjtcclxuICAgIH0gZWxzZSBpZiAoZGV2aWNlcykge1xyXG4gICAgICBhY3Rpb25UeXBlUmVmLmN1cnJlbnQgPSBcIm1vdmVcIjtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVNb3VzZVVwOiBNb3VzZUV2ZW50SGFuZGxlciA9IChlKSA9PiB7XHJcbiAgICBpZiAoIWludGVyYWN0aXZlKSByZXR1cm5cclxuXHJcbiAgICBpZiAoYWN0aW9uVHlwZVJlZi5jdXJyZW50ID09PSBcInNlbGVjdFwiICYmIG1vdXNlQnV0dG9uRG93blJlZi5jdXJyZW50ID09PSBNb3VzZUJ1dHRvblR5cGUuTGVmdENsaWNrKSB7XHJcbiAgICAgIHJlbmRlckpzb24odG9wb0pzb24pO1xyXG5cclxuICAgICAgY29uc3QgcG9zaXRpb24gPSBwYWdlTW91c2VQb3NpdGlvblRvQ2FudmFzUG9zaXRpb24oZS5wYWdlWCwgZS5wYWdlWSk7XHJcblxyXG4gICAgICBzZXRTZWxlY3RlZERldmljZXMoXHJcbiAgICAgICAgZ2V0RGV2aWNlSW5ab25lKFxyXG4gICAgICAgICAgTWF0aC5taW4obW91c2VEb3duUG9zUmVmLmN1cnJlbnQueCwgcG9zaXRpb24ueCksXHJcbiAgICAgICAgICBNYXRoLm1pbihtb3VzZURvd25Qb3NSZWYuY3VycmVudC55LCBwb3NpdGlvbi55KSxcclxuICAgICAgICAgIE1hdGgubWF4KG1vdXNlRG93blBvc1JlZi5jdXJyZW50LngsIHBvc2l0aW9uLngpLFxyXG4gICAgICAgICAgTWF0aC5tYXgobW91c2VEb3duUG9zUmVmLmN1cnJlbnQueSwgcG9zaXRpb24ueSlcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgYWN0aW9uVHlwZVJlZi5jdXJyZW50ID0gXCJzZWxlY3RcIjtcclxuICAgIGNhbnZhc1JlZi5jdXJyZW50LnN0eWxlLmN1cnNvciA9IFwiZGVmYXVsdFwiO1xyXG4gICAgbW91c2VCdXR0b25Eb3duUmVmLmN1cnJlbnQgPSBNb3VzZUJ1dHRvblR5cGUuTm9uZTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVNb3VzZU1vdmU6IE1vdXNlRXZlbnRIYW5kbGVyID0gYXN5bmMgKGUpID0+IHtcclxuICAgIGlmICghaW50ZXJhY3RpdmUpIHJldHVyblxyXG5cclxuICAgIGlmIChtb3VzZUJ1dHRvbkRvd25SZWYuY3VycmVudCA9PT0gTW91c2VCdXR0b25UeXBlLk1pZGRsZUNsaWNrKSB7XHJcbiAgICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnggKz0gZS5tb3ZlbWVudFg7XHJcbiAgICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnkgKz0gZS5tb3ZlbWVudFk7XHJcbiAgICAgIHJlbmRlckpzb24odG9wb0pzb24pO1xyXG4gICAgfSBlbHNlIGlmIChcclxuICAgICAgbW91c2VCdXR0b25Eb3duUmVmLmN1cnJlbnQgPT09IE1vdXNlQnV0dG9uVHlwZS5MZWZ0Q2xpY2sgJiZcclxuICAgICAgYWN0aW9uVHlwZVJlZi5jdXJyZW50ID09PSBcInNlbGVjdFwiXHJcbiAgICApIHtcclxuICAgICAgY29uc3QgcG9zaXRpb24gPSBwYWdlTW91c2VQb3NpdGlvblRvQ2FudmFzUG9zaXRpb24oZS5wYWdlWCwgZS5wYWdlWSk7XHJcbiAgICAgIGF3YWl0IHJlbmRlckpzb24odG9wb0pzb24pO1xyXG4gICAgICByZW5kZXJTZWxlY3Rpb24ocG9zaXRpb24ueCwgcG9zaXRpb24ueSk7XHJcbiAgICB9IGVsc2UgaWYgKFxyXG4gICAgICBtb3VzZUJ1dHRvbkRvd25SZWYuY3VycmVudCA9PT0gTW91c2VCdXR0b25UeXBlLkxlZnRDbGljayAmJlxyXG4gICAgICBhY3Rpb25UeXBlUmVmLmN1cnJlbnQgPT09IFwibW92ZVwiXHJcbiAgICApIHtcclxuICAgICAgc2VsZWN0ZWREZXZpY2VzLmZvckVhY2goKGRldmljZSkgPT4ge1xyXG4gICAgICAgIGRldmljZS5wb3NpdGlvbi54ICs9IGUubW92ZW1lbnRYO1xyXG4gICAgICAgIGRldmljZS5wb3NpdGlvbi55ICs9IGUubW92ZW1lbnRZO1xyXG4gICAgICB9KTtcclxuICAgICAgcmVuZGVySnNvbih0b3BvSnNvbik7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChtb3VzZUJ1dHRvbkRvd25SZWYuY3VycmVudCA9PT0gTW91c2VCdXR0b25UeXBlLkxlZnRDbGljayAmJlxyXG4gICAgICAoYWN0aW9uVHlwZVJlZi5jdXJyZW50ID09PSBcInNjcm9sbFhcIiB8fCBhY3Rpb25UeXBlUmVmLmN1cnJlbnQgPT09IFwic2Nyb2xsWVwiKSkge1xyXG5cclxuICAgICAgLy8gVE9ETzogcmV2b2lyIGxlIHJhdGlvbiBwb3VyIGJvdWdlciBsYSBzY3JvbGwgYmFyIHBsdXRvdCBxdWUgbGUgY2FudmFzXHJcblxyXG4gICAgICBpZiAoYWN0aW9uVHlwZVJlZi5jdXJyZW50ID09PSBcInNjcm9sbFhcIikge1xyXG4gICAgICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnggLT0gZS5tb3ZlbWVudFg7XHJcbiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uVHlwZVJlZi5jdXJyZW50ID09PSBcInNjcm9sbFlcIikge1xyXG4gICAgICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnkgLT0gZS5tb3ZlbWVudFk7XHJcbiAgICAgIH1cclxuICAgICAgcmVuZGVySnNvbih0b3BvSnNvbik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlV2hlZWw6IFdoZWVsRXZlbnRIYW5kbGVyID0gKGUpID0+IHtcclxuICAgIGlmICghaW50ZXJhY3RpdmUpIHJldHVyblxyXG5cclxuICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnkgLT0gZS5kZWx0YVk7XHJcbiAgICBjYW52YXNDZW50ZXIuY3VycmVudC54IC09IGUuZGVsdGFYO1xyXG5cclxuICAgIGlmIChhY3Rpb25UeXBlUmVmLmN1cnJlbnQgPT09IFwibW92ZVwiICYmIG1vdXNlQnV0dG9uRG93blJlZi5jdXJyZW50ID09PSBNb3VzZUJ1dHRvblR5cGUuTGVmdENsaWNrKSB7XHJcbiAgICAgIHNlbGVjdGVkRGV2aWNlcy5mb3JFYWNoKChkZXZpY2UpID0+IHtcclxuICAgICAgICBkZXZpY2UucG9zaXRpb24ueSArPSBlLmRlbHRhWTtcclxuICAgICAgICBkZXZpY2UucG9zaXRpb24ueSArPSBlLmRlbHRhWDtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySnNvbih0b3BvSnNvbik7XHJcbiAgfTtcclxuXHJcbiAgLy8jZW5kcmVnaW9uXHJcblxyXG4gIC8vI3JlZ2lvbiBrZXlib2FyZCBldmVudHNcclxuXHJcbiAgY29uc3QgaGFuZGxlS2V5RG93bjogS2V5Ym9hcmRFdmVudEhhbmRsZXIgPSAoZSkgPT4ge1xyXG4gICAgaWYgKCFpbnRlcmFjdGl2ZSkgcmV0dXJuXHJcblxyXG4gICAgaWYgKGUua2V5ID09PSBcIlNoaWZ0XCIpIHtcclxuICAgICAgaXNNYWpQcmVzc2VkUmVmLmN1cnJlbnQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgaWYgKGUua2V5ID09PSBcImFcIiAmJiBlLmN0cmxLZXkpIHtcclxuICAgICAgc2V0U2VsZWN0ZWREZXZpY2VzKHRvcG9Kc29uLmRldmljZXMpO1xyXG4gICAgfVxyXG4gICAgaWYgKGUua2V5ID09PSBcIkRlbGV0ZVwiIHx8IGUua2V5ID09PSBcIkJhY2tzcGFjZVwiKSB7XHJcbiAgICAgIHRvcG9Kc29uLmRldmljZXMgPSB0b3BvSnNvbi5kZXZpY2VzLmZpbHRlcihcclxuICAgICAgICAoZGV2aWNlKSA9PiAhc2VsZWN0ZWREZXZpY2VzLmluY2x1ZGVzKGRldmljZSlcclxuICAgICAgKTtcclxuICAgICAgc2V0U2VsZWN0ZWREZXZpY2VzKFtdKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVLZXlVcDogS2V5Ym9hcmRFdmVudEhhbmRsZXIgPSAoZSkgPT4ge1xyXG4gICAgaWYgKCFpbnRlcmFjdGl2ZSkgcmV0dXJuXHJcblxyXG4gICAgaWYgKGUua2V5ID09PSBcIlNoaWZ0XCIpIHtcclxuICAgICAgaXNNYWpQcmVzc2VkUmVmLmN1cnJlbnQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyNlbmRyZWdpb25cclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIHJlc2l6ZSh0cnVlKTtcclxuICAgIGlmIChjYW52YXNDZW50ZXIuY3VycmVudCkge1xyXG4gICAgICBvYnNlcnZlci5jdXJyZW50Lm9ic2VydmUoY2FudmFzUmVmLmN1cnJlbnQpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gc3RhcnQgb2JzZXJ2aW5nIGZvciByZXNpemVcclxuICB9LCBbY2FudmFzQ2VudGVyLCBvYnNlcnZlcl0pO1xyXG5cclxuICBjb25zdCByZXNpemUgPSAoY2hhbmdlQ2VudGVyID0gZmFsc2UpID0+IHtcclxuICAgIGlmICghY2FudmFzUmVmLmN1cnJlbnQpIHJldHVybjtcclxuICAgIGNvbnN0IHJlY3QgPSBjYW52YXNSZWYuY3VycmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICBjYW52YXNSZWYuY3VycmVudC53aWR0aCA9IHJlY3Qud2lkdGg7XHJcbiAgICBjYW52YXNSZWYuY3VycmVudC5oZWlnaHQgPSByZWN0LmhlaWdodDtcclxuXHJcbiAgICBpZiAoY2hhbmdlQ2VudGVyKSB7XHJcbiAgICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnggPSByZWN0LndpZHRoIC8gMjtcclxuICAgICAgY2FudmFzQ2VudGVyLmN1cnJlbnQueSA9IHJlY3QuaGVpZ2h0IC8gMjtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJKc29uKHRvcG9Kc29uKTtcclxuICB9XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBjb25zdCBmbiA9IGFzeW5jICgpID0+IHJlbmRlckpzb24odG9wb0pzb24pXHJcbiAgICBmbigpO1xyXG4gIH0sIFt0b3BvSnNvbiwgc2VsZWN0ZWREZXZpY2VzXSk7XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZiAoIWludGVyYWN0aXZlKSB7XHJcbiAgICAgIGNvbnN0IG1vc3RMZWZ0RGV2aWNlUG9zaXRpb24gPVxyXG4gICAgICAgIHRvcG9Kc29uLmRldmljZXM/LnJlZHVjZSgocHJldiwgY3VycikgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIGN1cnIucG9zaXRpb24ueCA8IHByZXYucG9zaXRpb24ueCA/IGN1cnIgOiBwcmV2O1xyXG4gICAgICAgIH0pPy5wb3NpdGlvbj8ueCAtXHJcbiAgICAgICAgZGV2aWNlU2l6ZS53aWR0aCAvIDI7XHJcblxyXG4gICAgICBjb25zdCBtb3N0UmlnaHREZXZpY2VQb3NpdGlvbiA9XHJcbiAgICAgICAgdG9wb0pzb24uZGV2aWNlcz8ucmVkdWNlKChwcmV2LCBjdXJyKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gY3Vyci5wb3NpdGlvbi54ID4gcHJldi5wb3NpdGlvbi54ID8gY3VyciA6IHByZXY7XHJcbiAgICAgICAgfSk/LnBvc2l0aW9uPy54ICtcclxuICAgICAgICBkZXZpY2VTaXplLndpZHRoIC8gMjtcclxuXHJcblxyXG4gICAgICBjb25zdCBtb3N0VG9wRGV2aWNlUG9zaXRpb24gPVxyXG4gICAgICAgIHRvcG9Kc29uLmRldmljZXM/LnJlZHVjZSgocHJldiwgY3VycikgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIGN1cnIucG9zaXRpb24ueSA8IHByZXYucG9zaXRpb24ueSA/IGN1cnIgOiBwcmV2O1xyXG4gICAgICAgIH0pLnBvc2l0aW9uLnkgLVxyXG4gICAgICAgIGRldmljZVNpemUuaGVpZ2h0IC8gMjtcclxuXHJcbiAgICAgIGNvbnN0IG1vc3RCb3R0b21EZXZpY2VQb3NpdGlvbiA9XHJcbiAgICAgICAgdG9wb0pzb24uZGV2aWNlcz8ucmVkdWNlKChwcmV2LCBjdXJyKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gY3Vyci5wb3NpdGlvbi55ID4gcHJldi5wb3NpdGlvbi55ID8gY3VyciA6IHByZXY7XHJcbiAgICAgICAgfSkucG9zaXRpb24ueSArIGRldmljZVNpemUuaGVpZ2h0O1xyXG5cclxuICAgICAgY29uc3QgeCA9IChtb3N0TGVmdERldmljZVBvc2l0aW9uICsgbW9zdFJpZ2h0RGV2aWNlUG9zaXRpb24pIC8gMlxyXG4gICAgICBjb25zdCB5ID0gKG1vc3RUb3BEZXZpY2VQb3NpdGlvbiArIG1vc3RCb3R0b21EZXZpY2VQb3NpdGlvbikgLyAyXHJcblxyXG5cclxuICAgICAgY2FudmFzQ2VudGVyLmN1cnJlbnQueCA9IGNhbnZhc0NlbnRlci5jdXJyZW50LnggLSB4XHJcbiAgICAgIGNhbnZhc0NlbnRlci5jdXJyZW50LnkgPSBjYW52YXNDZW50ZXIuY3VycmVudC55IC0geVxyXG4gICAgICByZW5kZXJKc29uKHRvcG9Kc29uKTtcclxuXHJcbiAgICB9XHJcbiAgfSwgW2ludGVyYWN0aXZlXSlcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICBmdW5jdGlvbiBkcmFnT3ZlcihlOiBhbnkpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGRyYWdFbnRlcihlOiBhbnkpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGRyYWdEcm9wKGU6IGFueSkge1xyXG4gICAgaWYgKCFpbnRlcmFjdGl2ZSkgcmV0dXJuXHJcblxyXG4gICAgY29uc3QgZGV2aWNlOiBEZXZpY2UgfCBudWxsID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgnZGV2aWNlJykgPyBKU09OLnBhcnNlKGUuZGF0YVRyYW5zZmVyLmdldERhdGEoJ2RldmljZScpKSA6IG51bGw7XHJcbiAgICBpZiAoZGV2aWNlKSB7XHJcbiAgICAgIGNvbnN0IHBvcyA9IHBhZ2VNb3VzZVBvc2l0aW9uVG9DYW52YXNQb3NpdGlvbihlLmNsaWVudFgsIGUuY2xpZW50WSlcclxuICAgICAgb25OZXcoZGV2aWNlLnR5cGUsIHBvcylcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiA8PlxyXG4gICAgPGNhbnZhc1xyXG4gICAgICB0YWJJbmRleD17MH1cclxuICAgICAgcmVmPXtjYW52YXNSZWZ9XHJcbiAgICAgIGNsYXNzTmFtZT17YCR7c3R5bGUuY2FudmFzfWB9XHJcbiAgICAgIG9uTW91c2VEb3duPXtoYW5kbGVNb3VzZURvd259XHJcbiAgICAgIG9uTW91c2VVcD17aGFuZGxlTW91c2VVcH1cclxuICAgICAgb25Nb3VzZUxlYXZlPXtoYW5kbGVNb3VzZVVwfVxyXG4gICAgICBvbk1vdXNlTW92ZT17aGFuZGxlTW91c2VNb3ZlfVxyXG4gICAgICBvbktleURvd249e2hhbmRsZUtleURvd259XHJcbiAgICAgIG9uS2V5VXA9e2hhbmRsZUtleVVwfVxyXG4gICAgICBvbldoZWVsPXtoYW5kbGVXaGVlbH1cclxuICAgICAgb25EcmFnT3Zlcj17ZHJhZ092ZXJ9XHJcbiAgICAgIG9uRHJhZ0VudGVyPXtkcmFnRW50ZXJ9XHJcbiAgICAgIG9uRHJvcD17ZHJhZ0Ryb3B9XHJcbiAgICA+PC9jYW52YXM+XHJcbiAgICB7bW91c2VEb3duRXZlbnQgJiYgPENvbnRleHRNZW51IG9uSGlkZT17KCkgPT4gc2V0TW91c2VEb3duRXZlbnQobnVsbCl9IG9wdGlvbnM9e2xhYk9wdGlvbnN9IHBvc2l0aW9uPXt7IHg6IG1vdXNlRG93bkV2ZW50Py5jbGllbnRYLCB5OiBtb3VzZURvd25FdmVudD8uY2xpZW50WSAtIDQwIH19PjwvQ29udGV4dE1lbnU+fVxyXG4gIDwvPlxyXG59OyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/pages/Playground/components/Canvas/Canvas.tsx\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("0d7445f8013c2d570705")
/******/ })();
/******/ 
/******/ }
);